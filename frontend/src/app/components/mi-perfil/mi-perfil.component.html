<!-- frontend/src/app/components/mi-perfil/mi-perfil.component.html -->
<div class="perfil-container" *ngIf="usuario">
  <div class="perfil-card">
    <div class="perfil-header">
      <div class="perfil-avatar">
        <img 
          [src]="usuario.imagenPerfil || '/assets/default-avatar.png'" 
          [alt]="usuario.nombre"
          class="avatar-img"
        >
      </div>
      <div class="perfil-info">
        <h2>{{ usuario.nombre }} {{ usuario.apellido }}</h2>
        <p class="usuario-handle">@{{ usuario.nombreUsuario }}</p>
        <p class="usuario-email">{{ usuario.correo }}</p>
      </div>
      <div class="perfil-acciones">
        <button 
          (click)="toggleEdicion()" 
          class="btn-secondary"
          [disabled]="cargando"
        >
          {{ editando ? 'Cancelar' : 'Editar Perfil' }}
        </button>
      </div>
    </div>

    <div class="perfil-content">
      <div *ngIf="!editando" class="perfil-vista">
        <div class="campo">
          <label>Descripci贸n:</label>
          <p>{{ usuario.descripcion || 'Sin descripci贸n' }}</p>
        </div>
        <div class="campo">
          <label>Fecha de registro:</label>
          <p>{{ usuario.fechaNacimiento | date:'dd/MM/yyyy' }}</p>
        </div>
        <div class="campo">
          <label>Perfil:</label>
          <p>{{ usuario.perfil }}</p>
        </div>
      </div>

      <div *ngIf="editando" class="perfil-edicion">
        <form (ngSubmit)="guardarCambios()" #perfilForm="ngForm">
          <div class="form-group">
            <label for="nombre">Nombre:</label>
            <input
              type="text"
              id="nombre"
              name="nombre"
              [(ngModel)]="nombre"
              required
              #nombreInput="ngModel"
            >
            <div *ngIf="nombreInput.invalid && nombreInput.touched" class="error-msg">
              El nombre es requerido
            </div>
          </div>

          <div class="form-group">
            <label for="apellido">Apellido:</label>
            <input
              type="text"
              id="apellido"
              name="apellido"
              [(ngModel)]="apellido"
            >
          </div>

          <div class="form-group">
            <label for="descripcion">Descripci贸n:</label>
            <textarea
              id="descripcion"
              name="descripcion"
              [(ngModel)]="descripcion"
              rows="4"
              maxlength="500"
            ></textarea>
          </div>

          <div *ngIf="error" class="error-msg">
            {{ error }}
          </div>

          <div class="form-acciones">
            <button
              type="submit"
              [disabled]="perfilForm.invalid || cargando"
              class="btn-primary"
            >
              {{ cargando ? 'Guardando...' : 'Guardar Cambios' }}
            </button>
          </div>
        </form>
      </div>
    </div>

    <div class="perfil-footer">
      <button (click)="cerrarSesion()" class="btn-danger">
        Cerrar Sesi贸n
      </button>
    </div>
  </div>
</div>

<div *ngIf="!usuario" class="loading">
  Cargando perfil...
</div>